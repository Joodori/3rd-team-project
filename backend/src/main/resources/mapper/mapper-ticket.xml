<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="lx.edu.levelup.feature.ticket.TicketRepository">

	<insert id="insertDB" parameterType="lx.edu.levelup.feature.ticket.TicketVO">
		insert into ticket(user_no, ticket_name, ticket_amount, ticket_money_status, ticket_reserve_date)
		values(#{userNo}, #{ticketName}, #{ticketAmount}, "입금대기", now())
	</insert>

	<select id="getTicketList" parameterType="int" resultType="lx.edu.levelup.feature.ticket.TicketResponseDTO">
		select *
		from ticket
		where user_no = #{user_no} and ticket_reserve_date >= CURDATE()
	</select>
	
	<!-- 관리자페이지에서 뜨는 입장권 리스트 -->
	<select id="getTicketListAdmin" parameterType="int" resultType="TicketResponseDTO">
		select *
		from ticket
		where ticket_reserve_date >= CURDATE()
	</select>

	<!-- 사용자가 입금하기를 눌렀을때 -->
	<update id="updateMoneyStatusUser" parameterType="int">
		update ticket
		set ticket_money_status="입금완료"
		where ticket_no = #{ticket_no}
	</update>
	
	<!-- 관리자가 입장권 입금 확인하기 눌렀을때 -->
	<update id="updateMoneyStatusManager" parameterType="int">
		update ticket
		set ticket_money_status='예약확정'
		where ticket_no = #{ticket_no}
	</update>

</mapper>